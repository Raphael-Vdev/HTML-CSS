!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="d6397d73-10b8-44a9-9a00-11bbd1c544f6",e._sentryDebugIdIdentifier="sentry-dbid-d6397d73-10b8-44a9-9a00-11bbd1c544f6")}catch(e){}}();var _global="undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{};_global.SENTRY_RELEASE={id:"4edc5f77"},(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1362],{81362:function(e,t,r){r.d(t,{Hg:function(){return E},QK:function(){return de},RI:function(){return s},z:function(){return N}});var n=r(48587),i=r(87708),o=r(25604);r(68935),r(52682);class s{constructor(e,t,r,n){this.fromA=e,this.toA=t,this.fromB=r,this.toB=n}offset(e,t){return new s(this.fromA+e,this.toA+e,this.fromB+t,this.toB+t)}}function a(e,t,r,n,i,o){if(e==n)return[];let f=m(e,t,r,n,i,o),u=g(e,t+f,r,n,i+f,o),p=(r-=u)-(t+=f),v=(o-=u)-(i+=f);if(!p||!v)return[new s(t,r,i,o)];if(p>v){let a=e.slice(t,r).indexOf(n.slice(i,o));if(a>-1)return[new s(t,t+a,i,i),new s(t+a+v,r,o,o)]}else if(v>p){let a=n.slice(i,o).indexOf(e.slice(t,r));if(a>-1)return[new s(t,t,i,i+a),new s(r,r,i+a+p,o)]}if(1==p||1==v)return[new s(t,r,i,o)];let w=A(e,t,r,n,i,o);if(w){let[s,l,f]=w;return a(e,t,s,n,i,l).concat(a(e,s+f,r,n,l+f,o))}return function(e,t,r,n,i,o){let a=r-t,f=o-i;if(Math.min(a,f)>16*l)return b(e,t,r,n,i,o);let u=Math.ceil((a+f)/2);h.reset(u),c.reset(u);let m=(r,o)=>e.charCodeAt(t+r)==n.charCodeAt(i+o),g=(t,i)=>e.charCodeAt(r-t-1)==n.charCodeAt(o-i-1),p=(a-f)%2!=0?c:null,A=p?null:h;for(let s=0;s<u;s++){if(s>l)return b(e,t,r,n,i,o);let v=h.advance(s,a,f,u,p,!1,m)||c.advance(s,a,f,u,A,!0,g);if(v)return d(e,t,r,t+v[0],n,i,o,i+v[1])}return[new s(t,r,i,o)]}(e,t,r,n,i,o)}let l=1e9;class f{constructor(){this.vec=[]}reset(e){this.len=e<<1;for(let t=0;t<this.len;t++)this.vec[t]=-1;this.vec[e+1]=0,this.start=this.end=0}advance(e,t,r,n,i,o,s){for(let a=-e+this.start;a<=e-this.end;a+=2){let l=n+a,f=a==-e||a!=e&&this.vec[l-1]<this.vec[l+1]?this.vec[l+1]:this.vec[l-1]+1,h=f-a;for(;f<t&&h<r&&s(f,h);)f++,h++;if(this.vec[l]=f,f>t)this.end+=2;else if(h>r)this.start+=2;else if(i){let e=n+(t-r)-a;if(e>=0&&e<this.len&&-1!=i.vec[e])if(o){let r=i.vec[e];if(r>=t-f)return[r,n+r-e]}else{if(f>=t-i.vec[e])return[f,h]}}}return null}}const h=new f,c=new f;function d(e,t,r,n,i,o,l,f){let h=!1;return L(e,n)||++n!=r||(h=!0),L(i,f)||++f!=l||(h=!0),h?[new s(t,r,o,l)]:a(e,t,n,i,o,f).concat(a(e,n,r,i,f,l))}function u(e,t){let r=1,n=Math.min(e,t);for(;r<n;)r<<=1;return r}function m(e,t,r,n,i,o){if(t==r||t==o||e.charCodeAt(t)!=n.charCodeAt(i))return 0;let s=u(r-t,o-i);for(let a=t,l=i;;){let i=a+s,f=l+s;if(i>r||f>o||e.slice(a,i)!=n.slice(l,f)){if(1==s)return a-t-(L(e,a)?0:1);s>>=1}else{if(i==r||f==o)return i-t;a=i,l=f}}}function g(e,t,r,n,i,o){if(t==r||i==o||e.charCodeAt(r-1)!=n.charCodeAt(o-1))return 0;let s=u(r-t,o-i);for(let a=r,l=o;;){let o=a-s,f=l-s;if(o<t||f<i||e.slice(o,a)!=n.slice(f,l)){if(1==s)return r-a-(L(e,a)?0:1);s>>=1}else{if(o==t||f==i)return r-o;a=o,l=f}}}function p(e,t,r,n,i,o,s,a){let l=n.slice(i,o),f=null;for(;;){if(f||s<a)return f;for(let a=t+s;;){L(e,a)||a++;let h=a+s;if(L(e,h)||(h+=h==a+1?1:-1),h>=r)break;let c=e.slice(a,h),d=-1;for(;-1!=(d=l.indexOf(c,d+1));){let s=m(e,h,r,n,i+d+c.length,o),l=g(e,t,a,n,i,i+d),u=c.length+s+l;(!f||f[2]<u)&&(f=[a-l,i+d-l,u])}a=h}if(a<0)return f;s>>=1}}function A(e,t,r,n,i,o){let s=r-t,a=o-i;if(s<a){let s=A(n,i,o,e,t,r);return s&&[s[1],s[0],s[2]]}return s<4||2*a<s?null:p(e,t,r,n,i,o,Math.floor(s/4),-1)}function b(e,t,r,n,i,o){let l,f=r-t,h=o-i;if(f<h){let s=p(n,i,o,e,t,r,Math.floor(f/6),50);l=s&&[s[1],s[0],s[2]]}else l=p(e,t,r,n,i,o,Math.floor(h/6),50);if(!l)return[new s(t,r,i,o)];let[c,d,u]=l;return a(e,t,c,n,i,d).concat(a(e,c+u,r,n,d+u,o))}function v(e,t){for(let r=1;r<e.length;r++){let n=e[r-1],i=e[r];n.toA>i.fromA-t&&n.toB>i.fromB-t&&(e[r-1]=new s(n.fromA,i.toA,n.fromB,i.toB),e.splice(r--,1))}}let w;try{w=new RegExp("[\\p{Alphabetic}\\p{Number}]","u")}catch(me){}function B(e){return e>48&&e<58||e>64&&e<91||e>96&&e<123}function k(e,t){if(t==e.length)return 0;let r=e.charCodeAt(t);return r<192?B(r)?1:0:w?y(r)&&t!=e.length-1?w.test(e.slice(t,t+2))?2:0:w.test(String.fromCharCode(r))?1:0:0}function C(e,t){if(!t)return 0;let r=e.charCodeAt(t-1);return r<192?B(r)?1:0:w?O(r)&&1!=t?w.test(e.slice(t-2,t))?2:0:w.test(String.fromCharCode(r))?1:0:0}function x(e,t,r){if(t==e.length||!C(e,t))return t;for(let n=t,i=t+r;;){let r=k(e,n);if(!r)return n;if(n+=r,n>i)return t}}function M(e,t,r){if(!t||!k(e,t))return t;for(let n=t,i=t-r;;){let r=C(e,n);if(!r)return n;if(n-=r,n<i)return t}}function D(e,t,r){for(let n=t,i=t-r;;){let r=n?e.charCodeAt(n-1):10;if(10==r)return n;if(n--,n<i||32!=r&&9!=r)return t}}const y=e=>e>=55296&&e<=56319,O=e=>e>=56320&&e<=57343;function L(e,t){return!t||t==e.length||!y(e.charCodeAt(t-1))||!O(e.charCodeAt(t))}function E(e,t,r){var n;return l=(null!==(n=null===r||void 0===r?void 0:r.scanLimit)&&void 0!==n?n:1e9)>>1,function(e,t,r){for(;;){v(r,1);let n=!1;for(let i=0;i<r.length;i++){let o,a,l=r[i];(o=m(e,l.fromA,l.toA,t,l.fromB,l.toB))&&(l=r[i]=new s(l.fromA+o,l.toA,l.fromB+o,l.toB)),(a=g(e,l.fromA,l.toA,t,l.fromB,l.toB))&&(l=r[i]=new s(l.fromA,l.toA-a,l.fromB,l.toB-a));let f=l.toA-l.fromA,h=l.toB-l.fromB;if(f&&h)continue;let c=l.fromA-(i?r[i-1].toA:0),d=(i<r.length-1?r[i+1].fromA:e.length)-l.toA;if(!c||!d)continue;let u=f?e.slice(l.fromA,l.toA):t.slice(l.fromB,l.toB);c<=u.length&&e.slice(l.fromA-c,l.fromA)==u.slice(u.length-c)?(r[i]=new s(l.fromA-c,l.toA-c,l.fromB-c,l.toB-c),n=!0):d<=u.length&&e.slice(l.toA,l.toA+d)==u.slice(0,d)&&(r[i]=new s(l.fromA+d,l.toA+d,l.fromB+d,l.toB+d),n=!0)}if(!n)break}return r}(e,t,a(e,0,e.length,t,0,t.length))}function R(e,t,r){return function(e,t,r){for(let n=0,i=0;i<e.length;i++){let o=e[i],a=o.toA-o.fromA,l=o.toB-o.fromB;if(a&&l||a>3||l>3){let f=i==e.length-1?t.length:e[i+1].fromA,h=o.fromA-n,c=f-o.toA,d=M(t,o.fromA,Math.min(h,5)),u=x(t,o.toA,Math.min(c,5)),m=o.fromA-d,g=u-o.toA;if(!a||!l){let c,p,A=Math.max(a,l),[b,v,w]=a?[t,o.fromA,o.toA]:[r,o.fromB,o.toB];m&&g?(A>m&&t.slice(d,o.fromA)==b.slice(w-m,w)?(o=e[i]=new s(d,d+a,o.fromB-m,o.toB-m),d=o.fromA,u=x(t,o.toA,Math.min(f-o.toA,5))):A>g&&t.slice(o.toA,u)==b.slice(v,v+g)&&(o=e[i]=new s(u-a,u,o.fromB+g,o.toB+g),u=o.toA,d=M(t,o.fromA,Math.min(o.fromA-n,5))),m=o.fromA-d,g=u-o.toA):m||g||!(p=o.fromA-(c=D(t,o.fromA,h)))||t.slice(c,o.fromA)!=b.slice(w-p,w)||(o=e[i]=new s(c,c+a,o.fromB-p,o.toB-p))}(m||g)&&(o=e[i]=new s(o.fromA-m,o.toA+g,o.fromB-m,o.toB+g)),n=o.toA}}return v(e,3),e}(E(e,t,r),e,t)}const S={scanLimit:500};class N{constructor(e,t,r,n,i){this.changes=e,this.fromA=t,this.toA=r,this.fromB=n,this.toB=i}offset(e,t){return e||t?new N(this.changes,this.fromA+e,this.toA+e,this.fromB+t,this.toB+t):this}get endA(){return Math.max(this.fromA,this.toA-1)}get endB(){return Math.max(this.fromB,this.toB-1)}static build(e,t){return _(R(e.toString(),t.toString(),S),e,t,0,0)}static updateA(e,t,r,n){return P(Q(e,n,!0,r.length),e,t,r)}static updateB(e,t,r,n){return P(Q(e,n,!1,t.length),e,t,r)}}function T(e,t,r,n){let i=r.lineAt(e),o=n.lineAt(t);return i.to==e&&o.to==t&&e<r.length&&t<n.length?[e+1,t+1]:[i.from,o.from]}function G(e,t,r,n){let i=r.lineAt(e),o=n.lineAt(t);return i.from==e&&o.from==t?[e,t]:[i.to+1,o.to+1]}function _(e,t,r,n,i){let o=[];for(let s=0;s<e.length;s++){let a=e[s],[l,f]=T(a.fromA+n,a.fromB+i,t,r),[h,c]=G(a.toA+n,a.toB+i,t,r),d=[a.offset(-l+n,-f+i)];for(;s<e.length-1;){let o=e[s+1],[a,u]=T(o.fromA+n,o.fromB+i,t,r);if(a>h+1&&u>c+1)break;d.push(o.offset(-l+n,-f+i)),[h,c]=G(o.toA+n,o.toB+i,t,r),s++}o.push(new N(d,l,Math.max(l,h),f,Math.max(f,c)))}return o}const V=1e3;function I(e,t,r,n){let i=0,o=e.length;for(;;){if(i==o){let n=0,o=0;i&&({toA:n,toB:o}=e[i-1]);let s=t-(r?n:o);return[n+s,o+s]}let s=i+o>>1,a=e[s],[l,f]=r?[a.fromA,a.toA]:[a.fromB,a.toB];if(l>t)o=s;else{if(!(f<=t))return n?[a.fromA,a.fromB]:[a.toA,a.toB];i=s+1}}}function Q(e,t,r,n){let i=[];return t.iterChangedRanges(((o,s,a,l)=>{let f=0,h=r?t.length:n,c=0,d=r?n:t.length;o>V&&([f,c]=I(e,o-V,r,!0)),s<t.length-V&&([h,d]=I(e,s+V,r,!1));let u,m=l-a-(s-o),[g,p]=r?[m,0]:[0,m];i.length&&(u=i[i.length-1]).toA>=f?i[i.length-1]={fromA:u.fromA,fromB:u.fromB,toA:h,toB:d,diffA:u.diffA+g,diffB:u.diffB+p}:i.push({fromA:f,toA:h,fromB:c,toB:d,diffA:g,diffB:p})})),i}function P(e,t,r,n){if(!e.length)return t;let i=0,o=0,s=0,a=[];for(let l of e){let e=l.fromA+o,f=l.toA+o+l.diffA,h=l.fromB+s,c=l.toB+s+l.diffB;for(;i<t.length;){let r=t[i];if(r.toA+o<=e&&r.toB+s<=h)a.push(r.offset(o,s));else if(r.fromA+o>f)break;i++}for(let t of _(R(r.sliceString(e,f),n.sliceString(h,c),S),r,n,e,h))a.push(t);o+=l.diffA,s+=l.diffB}for(;i<t.length;)a.push(t[i++].offset(o,s));return a}const q=i.Py.define(),H=i.QQ.define({create:e=>null,update(e,t){for(let r of t.effects)r.is(q)&&(e=r.value);return e}}),U=i.r$.define({combine:e=>e[0]}),F=n.lg.fromClass(class{constructor(e){({deco:this.deco,gutter:this.gutter}=K(e))}update(e){var t,r;(e.docChanged||e.viewportChanged||(t=e.startState,r=e.state,t.field(H,!1)!=r.field(H,!1))||function(e,t){return e.facet(U)!=t.facet(U)}(e.startState,e.state))&&({deco:this.deco,gutter:this.gutter}=K(e.view))}},{decorations:e=>e.deco}),z=i.Wl.low((0,n.v5)({class:"cm-changeGutter",markers:e=>{var t;return(null===(t=e.plugin(F))||void 0===t?void 0:t.gutter)||i.Xs.empty}}));const X=n.p.line({class:"cm-changedLine"}),Y=n.p.mark({class:"cm-changedText"}),W=n.p.mark({tagName:"ins"}),$=n.p.mark({tagName:"del"}),j=new class extends n.SJ{constructor(){super(...arguments),this.elementClass="cm-changedLineGutter"}};function J(e,t,r,n,i,o){let s=r?e.fromA:e.fromB,a=r?e.toA:e.toB,l=0;if(s!=a){i.add(s,s,X),i.add(s,a,r?$:W),o&&o.add(s,s,j);for(let f=t.iterRange(s,a-1),h=s;!f.next().done;){if(f.lineBreak){h++,i.add(h,h,X),o&&o.add(h,h,j);continue}let t=h+f.value.length;if(n)for(;l<e.changes.length;){let n=e.changes[l],o=s+(r?n.fromA:n.fromB),a=s+(r?n.toA:n.toB),f=Math.max(h,o),c=Math.min(t,a);if(f<c&&i.add(f,c,Y),!(a<t))break;l++}h=t}}}function K(e){let t=e.state.field(H),{side:r,highlightChanges:n,markGutter:o}=e.state.facet(U),s="a"==r,a=new i.f_,l=o?new i.f_:null,{from:f,to:h}=e.viewport;for(let i of t){if((s?i.fromA:i.fromB)>=h)break;(s?i.toA:i.toB)>f&&J(i,e.state.doc,s,n,a,l)}return{deco:a.finish(),gutter:l&&l.finish()}}class Z extends n.l9{constructor(e){super(),this.height=e}eq(e){return this.height==e.height}toDOM(){let e=document.createElement("div");return e.className="cm-mergeSpacer",e.style.height=this.height+"px",e}updateDOM(e){return e.style.height=this.height+"px",!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}const ee=i.Py.define({map:(e,t)=>e.map(t)}),te=i.QQ.define({create:()=>n.p.none,update:(e,t)=>{for(let r of t.effects)if(r.is(ee))return r.value;return e.map(t.changes)},provide:e=>n.tk.decorations.from(e)}),re=1e-4;const ne=i.Py.define({map:(e,t)=>t.mapPos(e)});class ie extends n.l9{constructor(e){super(),this.lines=e}eq(e){return this.lines==e.lines}toDOM(e){let t=document.createElement("div");return t.className="cm-collapsedLines",t.textContent="\u299a "+e.state.phrase("$ unchanged lines",this.lines)+" \u299a",t.addEventListener("click",(t=>{let r=e.posAtDOM(t.target);e.dispatch({effects:ne.of(r)});let{side:n,sibling:i}=e.state.facet(U);i&&i().dispatch({effects:ne.of(oe(r,e.state.field(H),"a"==n))})})),t}ignoreEvent(e){return e instanceof MouseEvent}get estimatedHeight(){return 27}}function oe(e,t,r){let n=0,i=0;for(let o=0;;o++){let s=o<t.length?t[o]:null;if(!s||(r?s.fromA:s.fromB)>=e)return i+(e-n);[n,i]=r?[s.toA,s.toB]:[s.toB,s.toA]}}const se=i.QQ.define({create:e=>n.p.none,update(e,t){e=e.map(t.changes);for(let r of t.effects)r.is(ne)&&(e=e.update({filter:e=>e!=r.value}));return e},provide:e=>n.tk.decorations.from(e)});function ae({margin:e=3,minSize:t=4}){return se.init((r=>function(e,t,r){let o=new i.f_,s="a"==e.facet(U).side,a=e.field(H),l=1;for(let i=0;;i++){let f=i<a.length?a[i]:null,h=i?l+t:1,c=f?e.doc.lineAt(s?f.fromA:f.fromB).number-1-t:e.doc.lines,d=c-h+1;if(d>=r&&o.add(e.doc.line(h).from,e.doc.line(c).to,n.p.replace({widget:new ie(d),block:!0})),!f)break;l=e.doc.lineAt(Math.min(e.doc.length,s?f.toA:f.toB)).number}return o.finish()}(r,e,t)))}const le=n.tk.styleModule.of(new o.V({".cm-mergeView":{overflowY:"auto"},".cm-mergeViewEditors":{display:"flex",alignItems:"stretch"},".cm-mergeViewEditor":{flexGrow:1,flexBasis:0,overflow:"hidden"},".cm-merge-revert":{width:"1.6em",flexGrow:0,flexShrink:0,position:"relative"},".cm-merge-revert button":{position:"absolute",display:"block",width:"100%",boxSizing:"border-box",textAlign:"center",background:"none",border:"none",font:"inherit",cursor:"pointer"}})),fe=n.tk.baseTheme({"& .cm-scroller, &":{height:"auto !important",overflowY:"visible !important"},"&.cm-merge-a .cm-changedLine, .cm-deletedChunk":{backgroundColor:"rgba(160, 128, 100, .08)"},"&.cm-merge-b .cm-changedLine":{backgroundColor:"rgba(100, 160, 128, .08)"},"&light.cm-merge-a .cm-changedText, &light .cm-deletedChunk .cm-deletedText":{background:"linear-gradient(#ee443366, #ee443366) bottom/100% 2px no-repeat"},"&dark.cm-merge-a .cm-changedText, &dark .cm-deletedChunk .cm-deletedText":{background:"linear-gradient(#ffaa9966, #ffaa9966) bottom/100% 2px no-repeat"},"&light.cm-merge-b .cm-changedText":{background:"linear-gradient(#22bb2266, #22bb2266) bottom/100% 2px no-repeat"},"&dark.cm-merge-b .cm-changedText":{background:"linear-gradient(#88ff8866, #88ff8866) bottom/100% 2px no-repeat"},"del, ins":{textDecoration:"none"},".cm-deletedChunk":{paddingLeft:"6px","& .cm-chunkButtons":{position:"absolute",insetInlineEnd:"5px"},"& button":{border:"none",cursor:"pointer",color:"white",margin:"0 2px",borderRadius:"3px","&[name=accept]":{background:"#2a2"},"&[name=reject]":{background:"#d43"}}},".cm-collapsedLines":{padding:"5px 5px 5px 10px",cursor:"pointer"},"&light .cm-collapsedLines":{color:"#444",background:"linear-gradient(to bottom, transparent 0, #f3f3f3 30%, #f3f3f3 70%, transparent 100%)"},"&dark .cm-collapsedLines":{color:"#ddd",background:"linear-gradient(to bottom, transparent 0, #222 30%, #222 70%, transparent 100%)"},".cm-changeGutter":{width:"3px",paddingLeft:"1px"},"&light.cm-merge-a .cm-changedLineGutter, &light .cm-deletedLineGutter":{background:"#e43"},"&dark.cm-merge-a .cm-changedLineGutter, &dark .cm-deletedLineGutter":{background:"#fa9"},"&light.cm-merge-b .cm-changedLineGutter":{background:"#2b2"},"&dark.cm-merge-b .cm-changedLineGutter":{background:"#8f8"}}),he=new i.F6,ce=new i.F6;class de{constructor(e){this.revertDOM=null,this.revertToA=!1,this.revertToLeft=!1,this.measuring=-1;let t=[i.Wl.low(F),fe,le,te,n.tk.updateListener.of((e=>{this.measuring<0&&(e.heightChanged||e.viewportChanged)&&!e.transactions.some((e=>e.effects.some((e=>e.is(ee)))))&&this.measure()}))],r=[U.of({side:"a",sibling:()=>this.b,highlightChanges:!1!==e.highlightChanges,markGutter:!1!==e.gutter})];!1!==e.gutter&&r.push(z);let o=i.yy.create({doc:e.a.doc,selection:e.a.selection,extensions:[e.a.extensions||[],n.tk.editorAttributes.of({class:"cm-merge-a"}),ce.of(r),t]}),s=[U.of({side:"b",sibling:()=>this.a,highlightChanges:!1!==e.highlightChanges,markGutter:!1!==e.gutter})];!1!==e.gutter&&s.push(z);let a=i.yy.create({doc:e.b.doc,selection:e.b.selection,extensions:[e.b.extensions||[],n.tk.editorAttributes.of({class:"cm-merge-b"}),ce.of(s),t]});this.chunks=N.build(o.doc,a.doc);let l=[H.init((()=>this.chunks)),he.of(e.collapseUnchanged?ae(e.collapseUnchanged):[])];o=o.update({effects:i.Py.appendConfig.of(l)}).state,a=a.update({effects:i.Py.appendConfig.of(l)}).state,this.dom=document.createElement("div"),this.dom.className="cm-mergeView",this.editorDOM=this.dom.appendChild(document.createElement("div")),this.editorDOM.className="cm-mergeViewEditors";let f=e.orientation||"a-b",h=document.createElement("div");h.className="cm-mergeViewEditor";let c=document.createElement("div");c.className="cm-mergeViewEditor",this.editorDOM.appendChild("a-b"==f?h:c),this.editorDOM.appendChild("a-b"==f?c:h),this.a=new n.tk({state:o,parent:h,root:e.root,dispatch:e=>this.dispatch(e,this.a)}),this.b=new n.tk({state:a,parent:c,root:e.root,dispatch:e=>this.dispatch(e,this.b)}),this.setupRevertControls(!!e.revertControls,"b-to-a"==e.revertControls,e.renderRevertControl),e.parent&&e.parent.appendChild(this.dom),this.scheduleMeasure()}dispatch(e,t){if(e.docChanged){this.chunks=t==this.a?N.updateA(this.chunks,e.newDoc,this.b.state.doc,e.changes):N.updateB(this.chunks,this.a.state.doc,e.newDoc,e.changes),t.update([e,e.state.update({effects:q.of(this.chunks)})]);let r=t==this.a?this.b:this.a;r.update([r.state.update({effects:q.of(this.chunks)})]),this.scheduleMeasure()}else t.update([e])}reconfigure(e){if("orientation"in e){let t="b-a"!=e.orientation;if(t!=(this.editorDOM.firstChild==this.a.dom.parentNode)){let e=this.a.dom.parentNode,r=this.b.dom.parentNode;e.remove(),r.remove(),this.editorDOM.insertBefore(t?e:r,this.editorDOM.firstChild),this.editorDOM.appendChild(t?r:e),this.revertToLeft=!this.revertToLeft,this.revertDOM&&(this.revertDOM.textContent="")}}if("revertControls"in e||"renderRevertControl"in e){let t=!!this.revertDOM,r=this.revertToA,n=this.renderRevert;"revertControls"in e&&(t=!!e.revertControls,r="b-to-a"==e.revertControls),"renderRevertControl"in e&&(n=e.renderRevertControl),this.setupRevertControls(t,r,n)}let t="highlightChanges"in e,r="gutter"in e,n="collapseUnchanged"in e;if(t||r||n){let i=[],o=[];if(t||r){let n=this.a.state.facet(U),s=r?!1!==e.gutter:n.markGutter,a=t?!1!==e.highlightChanges:n.highlightChanges;i.push(ce.reconfigure([U.of({side:"a",sibling:()=>this.b,highlightChanges:a,markGutter:s}),s?z:[]])),o.push(ce.reconfigure([U.of({side:"b",sibling:()=>this.a,highlightChanges:a,markGutter:s}),s?z:[]]))}if(n){let t=he.reconfigure(e.collapseUnchanged?ae(e.collapseUnchanged):[]);i.push(t),o.push(t)}this.a.dispatch({effects:i}),this.b.dispatch({effects:o})}this.scheduleMeasure()}setupRevertControls(e,t,r){this.revertToA=t,this.revertToLeft=this.revertToA==(this.editorDOM.firstChild==this.a.dom.parentNode),this.renderRevert=r,!e&&this.revertDOM?(this.revertDOM.remove(),this.revertDOM=null):e&&!this.revertDOM?(this.revertDOM=this.editorDOM.insertBefore(document.createElement("div"),this.editorDOM.firstChild.nextSibling),this.revertDOM.addEventListener("mousedown",(e=>this.revertClicked(e))),this.revertDOM.className="cm-merge-revert"):this.revertDOM&&(this.revertDOM.textContent="")}scheduleMeasure(){if(this.measuring<0){let e=this.dom.ownerDocument.defaultView||window;this.measuring=e.requestAnimationFrame((()=>{this.measuring=-1,this.measure()}))}}measure(){!function(e,t,r){let o=new i.f_,s=new i.f_,a=e.viewportLineBlocks,l=t.viewportLineBlocks,f=0,h=0,c=e.state.field(te).iter(),d=t.state.field(te).iter(),u=0,m=0,g=0,p=0;e:for(let i=0;;i++){let A=i<r.length?r[i]:null,[b,v]=A?[A.fromA,A.fromB]:[e.state.doc.length,t.state.doc.length];if(u<b&&m<v)for(;;){if(f==a.length||h==l.length)break e;let e=a[f],t=l[h];for(;c.value&&c.from<e.from;)g-=c.value.spec.widget.height,c.next();for(;d.value&&d.from<t.from;)p-=d.value.spec.widget.height,d.next();if(e.from>=b||t.from>=v)break;let r=e.from-u,i=t.from-m;if(r<0||r<i)f++;else if(i<0||i<r)h++;else{let r=e.top+g-(t.top+p);r<-1e-4?(g-=r,o.add(e.from,e.from,n.p.widget({widget:new Z(-r),block:!0,side:-1}))):r>re&&(p+=r,s.add(t.from,t.from,n.p.widget({widget:new Z(r),block:!0,side:-1}))),f++,h++}}if(!A)break;u=A.toA,m=A.toB}for(;c.value;)g-=c.value.spec.widget.height,c.next();for(;d.value;)p-=d.value.spec.widget.height,d.next();let A=e.contentHeight+g-(t.contentHeight+p);A<re?o.add(e.state.doc.length,e.state.doc.length,n.p.widget({widget:new Z(-A),block:!0,side:1})):A>re&&s.add(t.state.doc.length,t.state.doc.length,n.p.widget({widget:new Z(A),block:!0,side:1}));let b=o.finish(),v=s.finish();i.Xs.eq([b],[e.state.field(te)])||e.dispatch({effects:ee.of(b)}),i.Xs.eq([v],[t.state.field(te)])||t.dispatch({effects:ee.of(v)})}(this.a,this.b,this.chunks),this.revertDOM&&this.updateRevertButtons()}updateRevertButtons(){let e=this.revertDOM,t=e.firstChild,r=this.a.viewport,n=this.b.viewport;for(let i=0;i<this.chunks.length;i++){let o=this.chunks[i];if(o.fromA>r.to||o.fromB>n.to)break;if(o.fromA<r.from||o.fromB<n.from)continue;let s=this.a.lineBlockAt(o.fromA).top+"px";for(;t&&+t.dataset.chunk<i;)t=ue(t);t&&t.dataset.chunk==String(i)?(t.style.top!=s&&(t.style.top=s),t=t.nextSibling):e.insertBefore(this.renderRevertButton(s,i),t)}for(;t;)t=ue(t)}renderRevertButton(e,t){let r;if(this.renderRevert)r=this.renderRevert();else{r=document.createElement("button");let e=this.a.state.phrase("Revert this chunk");r.setAttribute("aria-label",e),r.setAttribute("title",e),r.textContent=this.revertToLeft?"\u21dc":"\u21dd"}return r.style.top=e,r.setAttribute("data-chunk",String(t)),r}revertClicked(e){let t,r=e.target;for(;r&&r.parentNode!=this.revertDOM;)r=r.parentNode;if(r&&(t=this.chunks[r.dataset.chunk])){let[r,n,i,o,s,a]=this.revertToA?[this.b,this.a,t.fromB,t.toB,t.fromA,t.toA]:[this.a,this.b,t.fromA,t.toA,t.fromB,t.toB],l=r.state.sliceDoc(i,Math.max(i,o-1));i!=o&&a<=n.state.doc.length&&(l+=r.state.lineBreak),n.dispatch({changes:{from:s,to:Math.min(n.state.doc.length,a),insert:l},userEvent:"revert"}),e.preventDefault()}}destroy(){this.a.destroy(),this.b.destroy(),this.measuring>-1&&(this.dom.ownerDocument.defaultView||window).cancelAnimationFrame(this.measuring),this.dom.remove()}}function ue(e){let t=e.nextSibling;return e.remove(),t}n.l9}}]);
//# sourceMappingURL=1362-5574cff4c4ee31bf.js.map